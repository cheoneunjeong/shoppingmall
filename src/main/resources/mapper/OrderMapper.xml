<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lcomputerstudy.example.mapper.OrderMapper">

	<insert id="insertOrderDetails" parameterType="OrderRequest">
		INSERT INTO order_details (
									p_code,
									order_num,
									COUNT,
									option)
				VALUES ( 	#{code},
							#{order_num},
							#{count},
							#{option} )
	</insert>

	<insert id="insertOrderInfo" parameterType="OrderInfo">
		INSERT INTO orderinfo (
									state,
									payway,
									point,
									total,
									user
									)
				VALUES ( 	#{state},
							#{payway},
							#{point},
							#{total},
							#{user} 
						)
	</insert>
	
	<update id="insertReceiverInfo" parameterType="ReceiverInfo">
		UPDATE orderinfo
		SET		receiver_address = 	#{address},
					receiver_postcode = #{receiver_postcode},
					receiver_name = #{receiver_name},
					receiver_phone = #{receiver_phone},
					receiver_same = #{same} 
		WHERE orderCode = LAST_INSERT_ID()
	</update>
	
	<select id="getOrderCode" resultType="Integer">
		SELECT orderCode FROM orderinfo ORDER BY DATETIME DESC LIMIT 1
	</select>
	
</mapper>
